#summary How to use ScalaCL in your projects
#labels Featured
#sidebar TOCWiki
<wiki:toc max_depth="3" />

You can use the ScalaCLPlugin with *any of the following options* : sbaz, sbt, Maven, eclipse...

= Prequisites =

  * OpenCL : If you want to use [ScalaCLCollections ScalaCL Collections], you need to [http://code.google.com/p/javacl/wiki/Usage#OpenCL_implementation install an OpenCL implementation].
  You don't need any OpenCL implementation for the general loops rewrite stuff !
  * Scala : ScalaCL was built with and for Scala 2.9.x (won't work with Scala 2.8.x unless you [Build build ScalaCL from sources] or [http://sourceforge.net/donate/index.php?group_id=266856 donate to the project] so some legacy target is deployed for you ;-))

= With scalac (using sbaz) : preferred method =

== Install =

If you're using [http://www.scala-lang.org/docu/files/tools/scalac.html scalac] in command line, the easiest way to test ScalaCL's compiler plugin is to use the following [http://www.scala-lang.org/node/93 sbaz] commands :
{{{
sbaz update
sbaz install scalacl
}}}
Then just use `scalac` as you're used to (the plugin will be enabled by default, see below for how to disable it). You don't need to specify the classpath of the [ScalaCLCollections], they should be readily available and automatically imported in `$SCALA_HOME/lib`.

== Uninstall ==

Should you wish to uninstall ScalaCL collections and compiler plugin, run :
{{{
sbaz remove scalacl
}}}

== Update ==

To update ScalaCL collections and compiler plugin :
{{{
sbaz update
sbaz remove scalacl
sbaz compact
sbaz install scalacl
}}}
Or if you don't care upgrading all your sbaz-managed packages :
{{{
sbaz update && sbaz upgrade
}}}

== Snapshots (development versions) ==

In addition to release and beta versions, some snapshots are regularly shared on sbaz. To list the available versions :
{{{
sbaz update
sbaz available -a
}}}
Look for the line that looks like :
{{{
scalacl (0.2.final, 0.2.Beta14, 0.2.Beta13, 0.2.Beta2, 0.2-SNAPSHOT_20110112_1048, ...)
}}}
You can then install a particular version with :
{{{
sbaz remove scalacl
sbaz install scalacl/0.2.final
}}}

= With scalac (manually) =

  * Download the latest version of ScalaCL Plugin :
  [http://nativelibs4java.sourceforge.net/maven/com/nativelibs4java/scalacl-compiler-plugin/0.3-SNAPSHOT/scalacl-compiler-plugin-0.3-SNAPSHOT.jar scalacl-compiler-plugin-0.3-SNAPSHOT.jar]
  * Make sure you've uninstalled any version of ScalaCL Plugin previously installed with sbaz :
{{{
sbaz remove scalacl
}}}
  * Use it like this (please do not rename the JAR or it won't work)
{{{
scalac -Xplugin:scalacl-compiler-plugin-0.3-SNAPSHOT.jar ...
}}}

= With sbt =

== sbt 0.10.x ==

To use ScalaCL's collections and/or compiler plugin with [http://code.google.com/p/simple-build-tool/ sbt] 0.10.x, please make your `build.sbt` file look like this :
{{{
resolvers += "NativeLibs4Java Repository" at "http://nativelibs4java.sourceforge.net/maven/"

libraryDependencies += "com.nativelibs4java" % "scalacl" % "0.2"

autoCompilerPlugins := true

addCompilerPlugin("com.nativelibs4java" % "scalacl-compiler-plugin" % "0.2")
}}}

== sbt 0.7.x ==

For sbt 0.7.x versions, here's what your project file (say, `project/build/ScalaCLTest.scala`) should look like :
{{{
import sbt._
class ScalaCLTest(info: ProjectInfo) extends DefaultProject(info) with AutoCompilerPlugins
{
  val nativelibs4javaRepo = "NativeLibs4Java Repository" at "http://nativelibs4java.sourceforge.net/maven/"
  // Current preferred beta version :
  val scalaclPlugin = compilerPlugin("com.nativelibs4java" % "scalacl-compiler-plugin" % "0.2")
  val scalacl = "com.nativelibs4java" % "scalacl" % "0.2"
  // Current development version : 
  //val scalaclPlugin = compilerPlugin("com.nativelibs4java" % "scalacl-compiler-plugin" % "0.3-SNAPSHOT")
  //val scalacl = "com.nativelibs4java" % "scalacl" % "0.3-SNAPSHOT"
}
}}}

Of course, do not forget to update to grab the package(s) :
{{{
sbt update
}}}

= With Maven =

The ScalaCL plugin can be used with [http://maven.apache.org/ Maven], simply edit your `pom.xml` as follows :
{{{
...
  <repositories>
    ...
    <repository>
      <id>nativelibs4java</id>
      <name>nativelibs4java Maven2 Repository</name>
      <url>http://nativelibs4java.sourceforge.net/maven</url>
    </repository>
  </repositories>

  <dependencies>
    <!-- Not needed if you do not care about OpenCL collections and just need general optimizations : -->
    <dependency>
      <groupId>com.nativelibs4java</groupId>
      <artifactId>scalacl</artifactId>
      <version>0.2</version>
    </dependency>
  </dependencies>

  <build>
    ...
    <plugins>
    	<plugin>
          <groupId>org.scala-tools</groupId>
          <artifactId>maven-scala-plugin</artifactId>
          <configuration>
            <compilerPlugins>
              <compilerPlugin>
                <groupId>com.nativelibs4java</groupId>
                <artifactId>scalacl-compiler-plugin</artifactId>
                <version>0.2</version>
                <!-- or "0.3-SNAPSHOT" to get the latest development version -->
              </compilerPlugin>
            </compilerPlugins>
          </configuration>
        </plugin>
    </plugins>
  </build>
...
}}}
If you choose the development version, Maven will automatically update the plugin to the latest available snapshot version each time you run it without the `-o` switch.

= With Eclipse =

== Configure the ScalaCL Compiler Plugin == 

Here's how to configure an [http://www.scala-ide.org/ Eclipse Scala] project so it uses the ScalaCL Compiler Plugin :
  * Download the [http://nativelibs4java.sourceforge.net/maven/com/nativelibs4java/scalacl-compiler-plugin/0.2/scalacl-compiler-plugin-0.2.jar latest stable version of the ScalaCL Compiler Plugin] (or the [http://nativelibs4java.sourceforge.net/maven/com/nativelibs4java/scalacl-compiler-plugin/0.3-SNAPSHOT/scalacl-compiler-plugin-0.3-SNAPSHOT.jar latest development version])
  * Open the section "Scala Compiler Properties" of Eclipse project's properties
  * Check "Use Project Settings" to enable the configuration items below
  * Fill the `Xplugin` field with the full path to the JAR you've downloaded, for instance :
{{{
/Users/ochafik/ScalaCLPlugin/target/scalacl-compiler-plugin-xxx.jar
}}}
  * Fill the `Xplugin-require` field with `scalacl` (just in case)
  * Clean your project, so it is rebuilt with the plugin enabled (menu `Project / Clean...`)
In case of issue, it is advised you compile using Maven or scalac+sbaz, because it seems the output from the compiler and from the compiler plugin is not visible from Eclipse.

= Disable the ScalaCL Compiler Plugin =

== Global disable ==

The plugin is enabled by default. To disable it, set the environment variable DISABLE_SCALACL_PLUGIN to 1 :
{{{
DISABLE_SCALACL_PLUGIN=1 scalac ...
}}}

== Selective disable (skip some files) ==

To disable optimizations for a whole file or at a specific line in a file, use the SCALACL_SKIP environment variable :
{{{
SCALACL_SKIP=file1,file2.scala,../path/to/file3.scala,file4:someLine,file5:someLine...
}}}
(this can be used to troubleshoot the ScalaCL Compiler Plugin : you can narrow compiler crashes down to the faulty line(s))